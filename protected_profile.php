<?php
session_start();

// Check if the user is authenticated
if (!isset($_SESSION['username'])) {
    header("Location: index.php"); // Redirect to the login page if not authenticated
    exit;
}

// Dummy database array with user information
$users = [
    ['user_id' => 1, 'username' => 'user1', 'password' => 'pass1', 'full_name' => 'John Doe', 'email' => 'john.doe@example.com', 'age' => 25],
    ['user_id' => 2, 'username' => 'user2', 'password' => 'pass2', 'full_name' => 'Jane Doe', 'email' => 'jane.doe@example.com', 'age' => 30],
    ['user_id' => 3, 'username' => 'user3', 'password' => 'pass3', 'full_name' => 'James Doe', 'email' => 'james.doe@example.com', 'age' => 35],
];

// Find the current user in the database
$currentUsername = $_SESSION['username'];
$currentUserData = null;

foreach ($users as $user) {
    if ($user['username'] === $currentUsername) {
        $currentUserData = $user;
        break;
    }
}

// Redirect if the user is not found in the database (this is an additional check for safety)
if ($currentUserData === null) {
    header("Location: index.php");
    exit;
}
?>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Protected Profile</title>
</head>
<body>

<h1>Protected Profile</h1>

<p>Welcome, <?php echo $currentUserData['full_name']; ?>!</p>

<!-- Display the protected profile data -->
<h2>Profile Information:</h2>
<ul>
    <li><strong>Full Name:</strong> <?php echo $currentUserData['full_name']; ?></li>
    <li><strong>Email:</strong> <?php echo $currentUserData['email']; ?></li>
    <li><strong>Age:</strong> <?php echo $currentUserData['age']; ?></li>
    <!-- Add more profile data as needed -->
</ul>

<p><a href="index.php?logout=1">Logout</a></p>

</body>
</html>